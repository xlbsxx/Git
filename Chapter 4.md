# 第四章 Git工具
## 4.1引用修订版本
### 4.1.1引用Commit的记录
切换至本项目工作目录，执行 `git log` 能看到类似提交日志的输出。

从日志能明显的看到多次提交的记录，每次包括 `commit` + 一串字符、作者、提交时间 和详细信息等。

想查看某次提交信息:`git show +哈希值`。

有时哈希值可以简化为前几个字符。
### 4.1.2 引用分支
如果你要查看一个分支的最后一次对象，可以通过分支名查看。查看本地分支列表通过`git branch`查看。

查看远程分支：`git branch -r`。

查看指定分支最后一次提交信息：`git show stable`。
### 4.1.3 引用日志
当你在工作时， Git 会在后台保存一个引用日志（reflog）， 
引用日志记录了最近几个月你的 HEAD 和分支引用所指向的历史。 你可以使用 `git reflog` 来查看引用日志。
## 4.2  交互式暂存
当你修改大量文件后，希望将改动拆分成多个提交而不是一起提交的时候，可以通过如下命令操作。

如果运行 `git add` 后加 `-i` 或者 `--interactive` 选项的时候，Git 会进入一个交互式命令模式。
### 4.2.1暂存、取消文件

在 `Waht now>>` 提示符后输入`u`或者`2`，它会提示你要暂存哪个文件。

如果想取消暂存，在 `Waht now>>` 提示符后输入`r`或者`3`，进行撤销，同上的操作。

如果想要查看已暂存内容的区别，可以使用 d 或 6（区别）命令。
### 4.2.2 暂存补丁
Git 也可以暂存文件的特定部分。 如果在文件中做了两处修改，但只想要暂存其中的一个而不是另一个，
Git 会帮你轻松地完成。 在和上一节一样的交互式提示符中，输入 p 或 5。

输入`p `后，选择你需要操作的文件后，直接敲回车，会逐一询问你是否需要暂存他们，
`(1/1)` 表示当前是第 1 个初变更，共 1 处变更。选项很多，输入?可以查看具体的解释。

通过`y`或者`n`来选择是否要暂存每一区块，当然也可以通过`a`暂存从这到后面所有当前文件的修改。
暂存成功后，退出交互命令，我们就可以通过`git commit`来提交这部分暂存的文件了。

## 4.3贮藏与清理
文件被修改了一大坨，但是还没修改完，暂时还不想提交，而我又想切换至新的分支，
这时候就需要`stash`，先把变更推送至栈上，运行`git stash` 或者 `git stash push`。

那么要返回刚才那坨文件该怎么办呢？通过` git stash list `查看所有 stash 的列表。

切换至最后 stash 变更，直接执行` git stash apply `即可，
当然如果有多个，可以通过 `git stash apply stash@{n} `中的 n 来获取指定的的变更。

可以通过` git stash drop `或者 `git stash pop `来删除 stash 的内容。
## 4.4 搜索
### 4.4.1 Git Grep
Git 提供了一个`grep`命令，可以很方便的从提交历史，工作目录，
甚至索引中查找一个字符串或者正则表达式。

默认情况下`git grep`会查找你的工作目录文件。

通过`n`或者`--line-number`显示匹配的行号。

通过`-c`或者`--count`输出统计信息。

通过`-p `或者 `--show-function` 显示每个匹配字符串所在的方法或函数。
### 4.4.2 Git 日志搜索
通过`git log`可以很强大的知道一些特定的提交信息。

通过`-S`选项知道内容的新增和删除提交记录。

通过`-L`选项进行行日志搜索，它可以展示代码中一行或者一个函数的历史。
## 4.5 子模块
### 4.5.1 添加子模块
通过 `git submodule add `添加子模块。

参数同` clone`，默认是 repo 的名称，如果你想改名，可以在后续增加新的名称或路径。

通过` git status `能看到新的 model 库。

通过`git diff`能看到更详细的信息。

虽然 model 是工作目录中的一个子目录，但 Git 还是会将它视作一个子模块。
当你不在那个目录中时，Git 并不会跟踪它的内容， 而是将它看作子模块仓库中的某个具体的提交。
### 4.5.2 克隆含有子模块的项目
- git submodule init 初始化本地配置文件
- git submodule update 则从该项目中抓取所有数据并检出父项目中列出的合适的提交
### 4.5.2 更新子模块
当子模块有更新的时候，执行` git submodule update --remote`。

该命令默认会更新 main 分支，如果你想设置为其他分支，可以在 `.gitmodules` 文件中设置 （这样其他人也可以跟踪它），也可以只在本地的 .git/config 文件中设置，我们在`.gitmodules`中配置它。

当运行 git submodule update --remote 时，Git 默认会尝试更新 所有 子模块， 所以如果有很多子模块的话，你可以传递想要更新的子模块的名字。如 `git submodule update --remote model`。
## 4.6 打包
通过 `git bundle`来实现。
